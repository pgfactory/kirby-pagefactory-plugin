/***************************
**  Styles for macro nav()
****************************/

@import '_scss-variables.scss';

//=== Defaults:
// dimensions:
$nav-txt-size: inherit;
//$nav-txt-size: 12pt;
$nav-elem-height: 2em;
$nav-line-height: 1.2em;	// -> space between wrapped lines
$nav-sub-width: 10em;

// colors general:
$nav-txt-color: inherit;
$nav-bg-color: transparent;	// -> bg of nav-block
$nav-elem-bg-color: #f8f8f8;

// sub-elements / dropdown:
$nav-sub-txt-color: inherit;
$nav-sub-bg-color: #f4f4f4;

// current:
$nav-curr-txt-color: #000;
$nav-curr-bg-color:  #ddd;
$nav-curr-marker-color:  red;
$nav-active-txt-color: #000;
//$nav-active-bg-color:  #efe;
$nav-active-bg-color:  #eee;
$nav-active-marker-color:  orange;

// hover:
$nav-hover-txt-color: #000;
$nav-hover-bg-color: #ddd;
$nav-hover-marker-color: yellow;

// arrow:
$nav-arrow-size: 1.3em;
$nav-arrow-left: 1.3em;
$nav-arrow-hover-color: gray;


// mobile nav:
$mobile-nav-font-size:    5vw;
$mobile-nav-txt-color:    #ddd;
$mobile-nav-bg-color:     #333;
$mobile-nav-title-indent: 20px;
$mobile-nav-first-indent: 20px;
$mobile-nav-indent-step:  20px;
$mobile-nav-width:        18rem;
$mxCorr: 1.8em;



// pfy-nav-horizontal:
$nav-horizontal-col-gap: 10px;
$nav-horizontal-padding: 0.5em;
$nav-horizontal-first-indent: 1.25em;
$nav-horizontal-indent-step: 1.25em;

// pfy-nav-accordion:
$nav-collapse-speed: 0.3s;

// pfy-nav-indented-no-arrow:
$nav-first-indent: 1.2em;
$nav-indent-step: 1.2em;

//=== in-page nav:
$in-page-first-indent: 0em;
$in-page-indent-step: 1em;





$slidedownX2: var(--pfy-nav-horizontal-first-indent, #{$nav-horizontal-first-indent});
$slidedownX3: calc(var(--pfy-nav-horizontal-first-indent, #{$nav-horizontal-first-indent}) + var(--pfy-nav-horizontal-indent-step, #{$nav-horizontal-indent-step}));
$slidedownX4: calc(var(--pfy-nav-horizontal-first-indent, #{$nav-horizontal-first-indent}) + 2 * var(--pfy-nav-horizontal-indent-step, #{$nav-horizontal-indent-step}));
$slidedownX5: calc(var(--pfy-nav-horizontal-first-indent, #{$nav-horizontal-first-indent}) + 3 * var(--pfy-nav-horizontal-indent-step, #{$nav-horizontal-indent-step}));
$slidedownX6: calc(var(--pfy-nav-horizontal-first-indent, #{$nav-horizontal-first-indent}) + 4 * var(--pfy-nav-horizontal-indent-step, #{$nav-horizontal-indent-step}));


@mixin _nav-a {
  position: relative;
  overflow: hidden;
  text-overflow: ellipsis;
  font-size: var(--pfy-nav-txt-size, #{$nav-txt-size});
  line-height: var(--pfy-nav-line-height, #{$nav-line-height});
  padding-top: calc( (var(--pfy-nav-elem-height, #{$nav-elem-height}) - 1.2em) / 2);
  padding-bottom: calc( (var(--pfy-nav-elem-height, #{$nav-elem-height}) - 1.2em) / 2);
  user-select: none;
}

// === Generic Nav ===================

#pfy.pfy-default-styling .pfy-nav-wrapper,
.pfy-default-styling .pfy-nav-wrapper {
    position: relative;
  // nav placeholder to avoid flicker:
  .pfy-top-nav-placeholder {
    @include _nav-a;
    height: calc(var(--pfy-nav-line-height, 1.2em) + var(--pfy-nav-elem-height, 2em) - 1.2em);
    margin: 0;
  }
} // .pfy-nav-wrapper





#pfy.pfy-default-styling .pfy-encapsulated.pfy-large-screen,
.pfy-default-styling.pfy-large-screen {

  // not .pfy-nav-colored -> apply CSS-variables:
  li {
    > a {
      color:      var(--pfy-nav-txt-color);
      background: var(--pfy-nav-elem-bg-color);
    }
    a:hover {
      color:      var(--pfy-nav-hover-txt-color);
      background: var(--pfy-nav-hover-bg-color, var(--pfy-nav-elem-bg-color));
    }
  }

  // pfy-curr:
  .pfy-curr.pfy-curr {
    > a {
      color:      var(--pfy-nav-curr-txt-color, var(--pfy-nav-txt-color));
      background: var(--pfy-nav-curr-bg-color, var(--pfy-nav-elem-bg-color));
    }
  }

  // pfy-active:
  .pfy-active.pfy-active {
    > a {
      color:      var(--pfy-nav-active-txt-color, var(--pfy-nav-txt-color));
      background: var(--pfy-nav-active-bg-color, var(--pfy-nav-elem-bg-color));
    }
  }

  // pfy-pseudo-elem:
  li.pfy-pseudo-elem {
    > a {
//      background: var(--pfy-nav-pseudo-elem-bg-color, var(--pfy-nav-elem-bg-color, #{$nav-active-bg-color}));
      cursor: s-resize;
    }
    &.pfy-open > a .pfy-nav-arrow,
    &.pfy-open > a {
      cursor: n-resize;
    }
  }

} // pfy-large-screen



#pfy.pfy-default-styling .pfy-encapsulated,
.pfy-default-styling {

  // === generic ===================================
  .pfy-nav,
  &.pfy-nav {

    // focus:
    :focus-visible {
      box-shadow:
        0 0 0 1px white,
        0 0 0 2px var(--pfy-focus-color, #{$focus-color2}),
        inset 0 0 0 1px var(--pfy-focus-color, #{$focus-color1}),
        inset 0 0 0 2px white,
        inset 0 0 0 3px var(--pfy-focus-color, #{$focus-color2});
    }
    :focus, a, a:visited, a:hover {
      border-bottom: none;
    }

    ul, ol, li {
      padding: 0;
      margin: 0;
    }
    ul, ol, li, a {
      display: block;
    }
    li {
      vertical-align: top;
      position: relative;
    }

    // gap bug fix:
    ul, ol, li {
      font-size: 0;
    }
    a,
    div {
      font-size: var(--pfy-nav-txt-size, #{$nav-txt-size});
    }

    // A element:
    a {
      @include _nav-a;
    }

    .pfy-nav-label {
      display: inline-block;
      height: var(--pfy-nav-line-height, 1.2em);
    }
    .pfy-nav-arrow {
      display: none;
      position: absolute;
      top: calc((var(--pfy-nav-elem-height, 2em) - 1.2em) / 2 - 0.1em);
      user-select: none;
      width: $nav-arrow-size;
      height: var(--pfy-nav-line-height, 1.2em);
      border-radius: 50%;
      svg {
          width: $nav-arrow-size;
          height: var(--pfy-nav-line-height, 1.2em);
        }
      border: 1px solid transparent;
    }
    // circle around hovered arrow:
    .pfy-nav-arrow:hover {
        border: 1px solid var(--nav-arrow-hover-color, $nav-arrow-hover-color);
    }

    // make frozen state visible:
    .pfy-branch-frozen .pfy-nav-arrow {
      transform: scale(1.3);
    }

    li.pfy-has-children > div {
        overflow: hidden;
    }

    //li.pfy-pseudo-elem > a {
    //  background: var(--pfy-nav-pseudo-elem-bg-color, var(--pfy-nav-elem-bg-color, #{$nav-active-bg-color}));
    //}
  } // generic .pfy-nav


  // === collapsed / collapsible ========================
  .pfy-nav-collapsed,
  &.pfy-nav-collapsed,
  .pfy-nav-collapsible,
  &.pfy-nav-collapsible {
      .pfy-nav-arrow {
          display: block;
      }

      // avoid flicker during slow loading:
      &.pfy-nav-horizontal li.pfy-lvl-1.pfy-has-children > div > ol {
          margin-top: -10000px;
      }
  } // pfy-nav-collapsed / collapsible


  // === collapsible open ===============================
  li.pfy-has-children.pfy-open {
    > div > ol {
      margin-top: 0 !important;
    }
  }




  // === indented ===================================
  .pfy-nav-indented,
  &.pfy-nav-indented { // no-arrow indentation:
      .pfy-lvl-1 {
          > a {
              padding-left: var(--pfy-nav-first-indent, #{$nav-first-indent});
          }
      }
      .pfy-lvl-2 {
          > a {
              padding-left: calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + var(--pfy-nav-indent-step, #{$nav-indent-step}));
          }
      }
      .pfy-lvl-3 {
          > a {
              padding-left: calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + 2 * var(--pfy-nav-indent-step, #{$nav-indent-step}));
          }
      }
      .pfy-lvl-4 {
          > a {
              padding-left: calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + 3 * var(--pfy-nav-indent-step, #{$nav-indent-step}));
          }
      }
      .pfy-lvl-5 {
          > a {
              padding-left: calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + 4 * var(--pfy-nav-indent-step, #{$nav-indent-step}));
          }
      }
      .pfy-lvl-6 {
          > a {
              padding-left: calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + 5 * var(--pfy-nav-indent-step, #{$nav-indent-step}));
          }
      }
  } // indentation



  // === animated ===================================
  .pfy-nav-animated,
  &.pfy-nav-animated {
      li.pfy-has-children {
          > div > ol {
            transition: margin-top var(--pfy-nav-collapse-speed, #{$nav-collapse-speed});
          }
      }
       .pfy-nav-arrow svg {
          transition: transform var(--pfy-nav-collapse-speed, #{$nav-collapse-speed});
      }
  } // pfy-nav-animated



  // === colored ===================================
  .pfy-nav-colored,
  &.pfy-nav-colored {
      // generic:
      a:visited,
      a {
          color: var(--pfy-nav-txt-color, #{$nav-txt-color});
      }

      // focus and hover:
      &.pfy-nav-colored.pfy-nav-colored.pfy-nav-colored {
          a:focus-visible {
              color:      var(--pfy-nav-focus-txt-color, var(--pfy-nav-hover-txt-color, #{$nav-hover-txt-color}));
              background: #{$nav-hover-bg-color};
              background: var(--pfy-nav-focus-bg-color,  var(--pfy-nav-hover-bg-color,  #{$nav-hover-bg-color}));
          }
          a:hover {
              color:      var(--pfy-nav-hover-txt-color, #{$nav-hover-txt-color});
              background: #{$nav-hover-bg-color};
              background: var(--pfy-nav-hover-bg-color,  #{$nav-hover-bg-color});
          }
      }

      li.pfy-pseudo-elem {
        > a {
          background: var(--pfy-nav-pseudo-elem-bg-color, var(--pfy-nav-elem-bg-color, #{$nav-active-bg-color}));
        }
      }

      // pfy-curr:
      .pfy-curr {
          > a {
              color:      var(--pfy-nav-curr-txt-color, var(--pfy-nav-txt-color, #{$nav-curr-txt-color}));
              background: #{$nav-curr-bg-color};
              background: var(--pfy-nav-curr-bg-color,  #{$nav-curr-bg-color});
          }
      }

      // pfy-active:
      .pfy-active {
          > a {
            color:      var(--pfy-nav-active-txt-color, var(--pfy-nav-txt-color, #{$nav-active-txt-color}));
            background: var(--pfy-nav-active-bg-color, var(--pfy-nav-elem-bg-color, #{$nav-active-bg-color}));
          }
      }


      // nav block:
      > ol {
          background: var(--pfy-nav-bg-color, transparent);
      }

      // level dependent:
      .pfy-lvl-1 {
          > a {
              background: var(--pfy-nav-elem-bg-color, #{$nav-elem-bg-color});
          }
      }
      .pfy-lvl-2 a {
          color: var(--pfy-nav-sub-txt-color, var(--pfy-nav-txt-color, currentColor) );
          background: var(--pfy-nav-sub-bg-color, #{$nav-sub-bg-color});
      }

      &:not(.pfy-nav-horizontal) {
          a {
              border-left: 3px solid transparent;
          }
          a:hover {
              border-left: 3px solid var(--nav-hover-marker-color, #{$nav-hover-marker-color});
          }
          &.pfy-active > a,
          .pfy-active > a {
              border-left: 3px solid var(--nav-active-marker-color, #{$nav-active-marker-color});
          }
          &.pfy-curr > a,
          .pfy-curr > a {
              border-left: 3px solid var(--nav-curr-marker-color, #{$nav-curr-marker-color});
          }
      }
  } // pfy-nav-colored


  // === Top Nav
  .pfy-nav-horizontal,
  &.pfy-nav-horizontal {

      a {
          padding-right: var(--pfy-nav-horizontal-padding, #{$nav-horizontal-padding});
      }

      ol {
          margin: 0;
          padding: 0;
      }

      > ol {
          font-size: 0;
      }

      li {
          vertical-align: top;
          position: relative;
          margin: 0;
      }

    .pfy-lvl-1:not(:last-child) {
      margin-right: var(--pfy-nav-horizontal-col-gap, #{$nav-horizontal-col-gap});
    }

      .pfy-lvl-1 {
          display: inline-block;
          margin: 0 2em 0 0;

          > a {
              display: inline-block;
              .pfy-nav-arrow {
                  display: inline-block;
                  svg {
                      transform: rotate(90deg);
                  }
              }
          }


          &.pfy-has-children {
              > a {
                  .pfy-nav-label {
                      margin-right: calc(#{$nav-arrow-size} - 0.5em);
                  }
                  .pfy-nav-arrow {
                      right: 0;
                      top: calc((var(--pfy-nav-elem-height, 2em) - 1.2em) / 2);
                  }
              }
              > div {
                  position: absolute;
                  top: 100%; // push below top level elem
                  left: 0;
                  width: var(--pfy-nav-sub-width, #{$nav-sub-width});
                  z-index: 102;
                  overflow: hidden;
              }
          }
      }

      &.pfy-nav-indented {
          .pfy-lvl-1 > a {
              padding-left: var(--pfy-nav-horizontal-padding, #{$nav-horizontal-padding});
          }

          .pfy-lvl-2 .pfy-nav-arrow {
              display: none;
          }

          .pfy-lvl-2 > a {
              padding-left: #{$slidedownX2};
          }

          .pfy-lvl-3 > a {
              padding-left: #{$slidedownX3};
          }

          .pfy-lvl-4 > a {
              padding-left: #{$slidedownX4};
          }

          .pfy-lvl-5 > a {
              padding-left: #{$slidedownX5};
          }

          .pfy-lvl-6 > a {
              padding-left: #{$slidedownX6};
          }
      }

  } // pfy-nav-horizontal



  // === Vertical =========================:
  .pfy-nav-vertical,
  &.pfy-nav-vertical {
      .pfy-hover,
      .pfy-open {
          > a > span.pfy-nav-arrow {
              svg {
                  transform: rotate(90deg);
              }
          }
      }
      a:visited,
      a {
          position: relative;
          .pfy-nav-label {
              display: block;
              hyphens: auto;
              text-overflow: ellipsis;
              overflow-x: hidden;
              width: 100%;
          }
      }
      .pfy-lvl-1 > a {
          padding-left: calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) );
          .pfy-nav-arrow {
              left: calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) - #{$nav-arrow-left} );
          }
      }
      .pfy-lvl-2 > a {
          padding-left: calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + var(--pfy-nav-indent-step, #{$nav-indent-step}));
          .pfy-nav-arrow {
              left:     calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + var(--pfy-nav-indent-step, #{$nav-indent-step}) - #{$nav-arrow-left} );
          }
      }
      .pfy-lvl-3 > a {
          padding-left: calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + 2 * var(--pfy-nav-indent-step, #{$nav-indent-step}));
          .pfy-nav-arrow {
              left:     calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + 2 * var(--pfy-nav-indent-step, #{$nav-indent-step}) - #{$nav-arrow-left} );
          }
      }
      .pfy-lvl-4 > a {
          padding-left: calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + 3 * var(--pfy-nav-indent-step, #{$nav-indent-step}));
          .pfy-nav-arrow {
              left:     calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + 3 * var(--pfy-nav-indent-step, #{$nav-indent-step}) - #{$nav-arrow-left} );
          }
      }
      .pfy-lvl-5 > a {
          padding-left: calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + 4 * var(--pfy-nav-indent-step, #{$nav-indent-step}));
          .pfy-nav-arrow {
              left:     calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + 4 * var(--pfy-nav-indent-step, #{$nav-indent-step}) - #{$nav-arrow-left} );
          }
      }
      .pfy-lvl-6 > a {
          padding-left: calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + 5 * var(--pfy-nav-indent-step, #{$nav-indent-step}));
          .pfy-nav-arrow {
              left:     calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + 5 * var(--pfy-nav-indent-step, #{$nav-indent-step}) - #{$nav-arrow-left} );
          }
      }
  } // vertical nav





/* for later use:
    //=== in-page nav:
    &.pfy-in-page-nav,
    .pfy-in-page-nav {
        ol {
            padding: 0;
        }
        li {
            list-style: none;
            display: block;
        }
        .H1 {
            padding-left: 1em;
            margin-left: var(--pfy-in-page-first-indent, #{$in-page-first-indent});
        }
        .H2 {
            padding-left: 2em;
            margin-left: calc(var(--pfy-in-page-first-indent, #{$in-page-first-indent}) + var(--pfy-in-page-indent-step, #{$in-page-indent-step}));
        }
        .H3 {
            padding-left: 3em;
            margin-left: calc(var(--pfy-in-page-first-indent, #{$in-page-first-indent}) + 2 * var(--pfy-in-page-indent-step, #{$in-page-indent-step}));
        }
        .H4 {
            padding-left: 4em;
            margin-left: calc(var(--pfy-in-page-first-indent, #{$in-page-first-indent}) + 3 * var(--pfy-in-page-indent-step, #{$in-page-indent-step}));
        }
        .H5 {
            padding-left: 5em;
            margin-left: calc(var(--pfy-in-page-first-indent, #{$in-page-first-indent}) + 4 * var(--pfy-in-page-indent-step, #{$in-page-indent-step}));
        }
        .H6 {
            padding-left: 6em;
            margin-left: calc(var(--pfy-in-page-first-indent, #{$in-page-first-indent}) + 5 * var(--pfy-in-page-indent-step, #{$in-page-indent-step}));
        }
    } // pfy-in-page-nav




    //=== breadcrumb:
    &.pfy-nav-breadcrumb,
    .pfy-nav-breadcrumb {
        margin: 0;
        padding: 0;
        li {
            list-style: none;
            display: inline-block;
            margin: 0;
            padding: 0;
        }
        .pfy-nav-breadcrumb-separator {
            position: relative;
            display: inline-block;
            width: 1.6em;
            text-align: center;
            font-family: Impact, Charcoal, sans-serif;
            opacity: 0.6;
        }
    } // pfy-nav-breadcrumb
*/

} // pfy-encapsulated


