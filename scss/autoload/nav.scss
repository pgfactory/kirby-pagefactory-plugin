/***************************
**  Styles for macro nav()
****************************/

@import '../_scss-variables.scss';

//=== Defaults:
// dimensions:
$nav-txt-size: 12pt;
$nav-elem-height: 2em;
$nav-line-height: 1.2em;	// -> space between wrapped lines
$nav-sub-width: 10em;

// colors general:
$nav-txt-color: inherit;
$nav-bg-color: transparent;	// -> bg of nav-block
$nav-elem-bg-color: #eee;

// sub-elements / dropdown:
$nav-sub-txt-color: inherit;
$nav-sub-bg-color: #ddd;

// current:
$nav-curr-txt-color: #000;
$nav-curr-bg-color:  #ddd;
$nav-active-txt-color: #000;
$nav-active-bg-color:  #eee;

// hover:
$nav-hover-txt-color: #000;
$nav-hover-bg-color: #ddd;

// arrow:
$nav-arrow-size: 1.3em;
$nav-arrow-left: 1.3em;
$nav-arrow-hover-color: gray;


// mobile nav:
$mobile-nav-font-size:    5vw;
$mobile-nav-txt-color:    #ddd;
$mobile-nav-bg-color:     #333;
$mobile-nav-title-indent: 20px;
$mobile-nav-first-indent: 20px;
$mobile-nav-indent-step:  20px;
$mobile-nav-width:        18rem;
$mxCorr: 1.8em;



// pfy-nav-top-horizontal:
$nav-top-horizontal-col-gap: 10px;
$nav-top-horizontal-padding: 0.5em;
$nav-top-horizontal-first-indent: 1.25em;
$nav-top-horizontal-indent-step: 1.25em;

// pfy-nav-accordion:
$nav-collapse-speed: 0.3s;

// pfy-nav-indented-no-arrow:
$nav-first-indent: 1.2em;
$nav-indent-step: 1.2em;

//=== in-page nav:
$in-page-first-indent: 0em;
$in-page-indent-step: 1em;





$slidedownX2: var(--pfy-nav-top-horizontal-first-indent, #{$nav-top-horizontal-first-indent});
$slidedownX3: calc(var(--pfy-nav-top-horizontal-first-indent, #{$nav-top-horizontal-first-indent}) + var(--pfy-nav-top-horizontal-indent-step, #{$nav-top-horizontal-indent-step}));
$slidedownX4: calc(var(--pfy-nav-top-horizontal-first-indent, #{$nav-top-horizontal-first-indent}) + 2 * var(--pfy-nav-top-horizontal-indent-step, #{$nav-top-horizontal-indent-step}));
$slidedownX5: calc(var(--pfy-nav-top-horizontal-first-indent, #{$nav-top-horizontal-first-indent}) + 3 * var(--pfy-nav-top-horizontal-indent-step, #{$nav-top-horizontal-indent-step}));
$slidedownX6: calc(var(--pfy-nav-top-horizontal-first-indent, #{$nav-top-horizontal-first-indent}) + 4 * var(--pfy-nav-top-horizontal-indent-step, #{$nav-top-horizontal-indent-step}));


// === Generic Nav ===================

#pfy.pfy-default-styling .pfy-nav-wrapper,
.pfy-default-styling .pfy-nav-wrapper {
    position: relative;
} // .pfy-nav-wrapper



#pfy.pfy-default-styling .pfy-encapsulated.pfy-small-screen,
.pfy-default-styling.pfy-small-screen {
  .pfy-nav-arrow {
    left: 0;
  }
}

#pfy.pfy-default-styling .pfy-encapsulated,
.pfy-default-styling {
  .pfy-nav :focus-visible {
    box-shadow:
      0 0 0 1px white,
      0 0 0 2px var(--pfy-focus-color, #{$focus-color2}),
      inset 0 0 0 1px var(--pfy-focus-color, #{$focus-color1}),
      inset 0 0 0 2px white,
      inset 0 0 0 3px var(--pfy-focus-color, #{$focus-color2});
  }

  nav,
  &nav {
      ul {
          padding: 0;
      }
      li {
          list-style-type: none;
      }
  }



    .pfy-nav,
    &.pfy-nav {
        ol, li, a {
            display: block;
            padding: 0;
            margin: 0;
        }
        a {
          position: relative;
          overflow: hidden;
          text-overflow: ellipsis;
          font-size: var(--pfy-nav-txt-size, #{$nav-txt-size});
          line-height: var(--pfy-nav-line-height, #{$nav-line-height});
          padding-top: calc( (var(--pfy-nav-elem-height, #{$nav-elem-height}) - 1.2em) / 2);
          padding-bottom: calc( (var(--pfy-nav-elem-height, #{$nav-elem-height}) - 1.2em) / 2);
          user-select: none;
        }
        &.pfy-nav {
            :focus,
            a, a:visited, a:hover {
                border-bottom: none;
            }
        }
        .pfy-nav-label {
            display: inline-block;
            height: $nav-arrow-size;
        }
        .pfy-nav-arrow {
          display: none;
          position: absolute;
          top: calc((var(--pfy-nav-elem-height, 2em) - 1.2em) / 2 - 0.1em);
          user-select: none;
          cursor: s-resize;
          width: $nav-arrow-size;
          height: $nav-arrow-size;
          border-radius: 50%;
          svg {
                width: $nav-arrow-size;
                height: $nav-arrow-size;
            }
        }
        .pfy-nav-arrow:hover {
            outline: 1px solid var(--nav-arrow-hover-color, $nav-arrow-hover-color);
        }

        li.pfy-has-children > div {
            overflow: hidden;
        }

        // all:
        li {
            > a {
                color:      var(--pfy-nav-txt-color);
                background: var(--pfy-nav-elem-bg-color);
            }
        }

        // pfy-curr:
        .pfy-curr.pfy-curr {
            > a {
                color:      var(--pfy-nav-curr-txt-color, var(--pfy-nav-txt-color, #{$nav-curr-txt-color}));
                background: var(--pfy-nav-curr-bg-color, var(--pfy-nav-elem-bg-color, #{$nav-curr-bg-color}));
            }
        }

        // pfy-active:
        .pfy-active.pfy-active {
            > a {
                color:      var(--pfy-nav-active-txt-color, var(--pfy-nav-txt-color, #{$nav-active-txt-color}));
                background: var(--pfy-nav-active-bg-color, var(--pfy-nav-elem-bg-color, #{$nav-active-bg-color}));
            }
        }

    } // generic .pfy-nav


    .pfy-nav-collapsed,
    &.pfy-nav-collapsed {
        .pfy-nav-arrow {
            display: block;
        }
        // this rule will be applied by jq, so, if ever there's a problem with js, the page can still be operated.
        //li.pfy-has-children > div > ol {
        //    margin-top: -10000px;
        //}

        // avoid flicker during slow loading:
        &.pfy-nav-top-horizontal li.pfy-lvl-1.pfy-has-children > div > ol {
            margin-top: -10000px;
        }
        li.pfy-has-children.pfy-open > div > ol {
            margin-top: 0 !important;
        }
    }
    .pfy-nav-collapsible,
    &.pfy-nav-collapsible {
        .pfy-nav-arrow {
            display: block;
        }
        li.pfy-has-children.pfy-open > div > ol {
            margin-top: 0 !important;
        }
    }


    .pfy-nav-hoveropen,
    &.pfy-nav-hoveropen {
        .pfy-hover ol {
            margin-top: 0 !important;
        }
    }


    .pfy-nav-indented,
    &.pfy-nav-indented { // no-arrow indentation:
        .pfy-lvl-1 {
            > a {
                padding-left: var(--pfy-nav-first-indent, #{$nav-first-indent});
            }
        }
        .pfy-lvl-2 {
            > a {
                padding-left: calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + var(--pfy-nav-indent-step, #{$nav-indent-step}));
            }
        }
        .pfy-lvl-3 {
            > a {
                padding-left: calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + 2 * var(--pfy-nav-indent-step, #{$nav-indent-step}));
            }
        }
        .pfy-lvl-4 {
            > a {
                padding-left: calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + 3 * var(--pfy-nav-indent-step, #{$nav-indent-step}));
            }
        }
        .pfy-lvl-5 {
            > a {
                padding-left: calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + 4 * var(--pfy-nav-indent-step, #{$nav-indent-step}));
            }
        }
        .pfy-lvl-6 {
            > a {
                padding-left: calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + 5 * var(--pfy-nav-indent-step, #{$nav-indent-step}));
            }
        }
    } // indentation


    // -> nav.js adds .pfy-nav-animation-active if wrapper has class ..pfy-nav-animated:
    .pfy-nav-animation-active,
    &.pfy-nav-animation-active {
        li.pfy-has-children {
            > div > ol {
                transition: margin-top var(--pfy-nav-collapse-speed, #{$nav-collapse-speed});
            }
        }
         .pfy-nav-arrow svg {
            transition: transform var(--pfy-nav-collapse-speed, #{$nav-collapse-speed});
        }
    } // animated


    .pfy-nav-colored,
    &.pfy-nav-colored {
        // generic:
        a:visited,
        a {
            color: var(--pfy-nav-txt-color, #{$nav-txt-color});
        }

        // focus and hover:
        &.pfy-nav-colored.pfy-nav-colored.pfy-nav-colored {
            a:focus-visible {
                color:      var(--pfy-nav-focus-txt-color, var(--pfy-nav-hover-txt-color, #{$nav-hover-txt-color}));
                background: #{$nav-hover-bg-color};
                background: var(--pfy-nav-focus-bg-color,  var(--pfy-nav-hover-bg-color,  #{$nav-hover-bg-color}));
            }
            a:hover {
                color:      var(--pfy-nav-hover-txt-color, #{$nav-hover-txt-color});
                background: #{$nav-hover-bg-color};
                background: var(--pfy-nav-hover-bg-color,  #{$nav-hover-bg-color});
            }
        }

        // pfy-curr:
        .pfy-curr {
            > a {
                color:      var(--pfy-nav-curr-txt-color, var(--pfy-nav-txt-color, #{$nav-curr-txt-color}));
                background: #{$nav-curr-bg-color};
                background: var(--pfy-nav-curr-bg-color,  #{$nav-curr-bg-color});
            }
        }

        // pfy-active:
        .pfy-active {
            > a {
                color:      var(--pfy-nav-active-txt-color, var(--pfy-nav-txt-color, #{$nav-txt-color}));
                background: #{$nav-sub-bg-color};
                background: var(--pfy-nav-active-bg-color,  #{$nav-sub-bg-color});
            }
        }


        // nav block:
        > ol {
            background: var(--pfy-nav-bg-color, transparent);
        }

        // level dependent:
        .pfy-lvl-1 {
            > a {
                background: #{$nav-elem-bg-color};
                background: var(--pfy-nav-elem-bg-color, #{$nav-elem-bg-color});
            }
        }
        .pfy-lvl-2 a {
            color: var(--pfy-nav-sub-txt-color, var(--pfy-nav-txt-color, currentColor) );
            background: #{$nav-sub-bg-color};
            background: var(--pfy-nav-sub-bg-color, #{$nav-sub-bg-color});
        }

        &:not(.pfy-nav-top-horizontal) {
            a {
                border-left: 3px solid transparent;
            }
            a:hover {
                border-left: 3px solid orange;
            }
            &.pfy-curr > a,
            .pfy-curr > a {
                border-left: 3px solid red;
            }
        }
    } // pfy-nav-colored


    // === Top Nav
    .pfy-nav-top-horizontal,
    &.pfy-nav-top-horizontal {
        // while in touch mode, the parent element can't be activated as it is reserved for opening/closing the accordion
        // thus we need to repeat that element in the text sub-menu, but hide it while not in touch mode:
        .pfy-nav-title {
            display: none;
        }
        // default color & background (opt. overridden by pfy-nav-colored):
        .pfy-lvl-2 a {
            color: var(--pfy-nav-sub-txt-color, var(--pfy-nav-txt-color, currentColor) );
            background: var(--pfy-nav-sub-bg-color, white);
        }

        li {
            vertical-align: top;
        }

        a,
        ol,
        div {
            font-size: var(--pfy-nav-txt-size, #{$nav-txt-size});
        }

        a {
            padding-right: var(--pfy-nav-top-horizontal-padding, #{$nav-top-horizontal-padding});
        }

        ol {
            margin: 0;
            padding: 0;
        }

        > ol {
            font-size: 0;
        }

        li {
            vertical-align: top;
            position: relative;
            margin: 0;
        }

        .pfy-lvl-1 {
            display: inline-block;
            margin: 0 2em 0 0;
            margin-right: var(--pfy-nav-top-horizontal-col-gap, #{$nav-top-horizontal-col-gap});

            > a {
                display: inline-block;
                .pfy-nav-arrow {
                    display: inline-block;
                    svg {
                        transform: rotate(90deg);
                    }
                }
            }


            &:last-child {
                margin-right: 0;
            }

            &.pfy-has-children {
                > a {
                    .pfy-nav-label {
                        margin-right: calc(#{$nav-arrow-size} - 0.5em);
                    }
                    .pfy-nav-arrow {
                        right: 0;
                        top: calc((var(--pfy-nav-elem-height, 2em) - 1.2em) / 2);
                    }
                }
                > div {
                    position: absolute;
                    top: 100%; // push below top level elem
                    left: 0;
                    width: var(--pfy-nav-sub-width, #{$nav-sub-width});
                    z-index: 102;
                    overflow: hidden;
                }
            }
        }

        .pfy-lvl-2 {
            //a {
            //    margin-bottom: 1px;
            //}
        }

        &.pfy-nav-colored div {
            background: white;
        }

        &:not(.pfy-nav-indented) {
            a {
                padding-left: #{$slidedownX2};
            }
        }

        &.pfy-nav-indented {
            .pfy-lvl-1 > a {
                padding-left: var(--pfy-nav-top-horizontal-padding, #{$nav-top-horizontal-padding});
            }

            .pfy-lvl-2 .pfy-nav-arrow {
                display: none;
            }

            .pfy-lvl-2 > a {
                padding-left: #{$slidedownX2};
            }

            .pfy-lvl-3 > a {
                padding-left: #{$slidedownX3};
            }

            .pfy-lvl-4 > a {
                padding-left: #{$slidedownX4};
            }

            .pfy-lvl-5 > a {
                padding-left: #{$slidedownX5};
            }

            .pfy-lvl-6 > a {
                padding-left: #{$slidedownX6};
            }
        }

        .pfy-nav-heading {
            display: inline-block;
            font-size: var(--pfy-nav-txt-size, #{$nav-txt-size});
            padding-left: var(--pfy-nav-top-horizontal-padding, #{$nav-top-horizontal-padding});
            vertical-align: top;
        }

    } // pfy-nav-top-horizontal



    // === Vertical nav:
    .pfy-nav-vertical,
    &.pfy-nav-vertical {
        .pfy-hover,
        .pfy-open {
            > a > span.pfy-nav-arrow {
                svg {
                    transform: rotate(90deg);
                }
            }
        }
        a:visited,
        a {
            position: relative;
            .pfy-nav-label {
                display: block;
                hyphens: auto;
                text-overflow: ellipsis;
                overflow-x: hidden;
                width: 100%;
            }
        }
        .pfy-lvl-1 > a {
            padding-left: calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) );
            .pfy-nav-arrow {
                left: calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) - #{$nav-arrow-left} );
            }
        }
        .pfy-lvl-2 > a {
            padding-left: calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + var(--pfy-nav-indent-step, #{$nav-indent-step}));
            .pfy-nav-arrow {
                left:     calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + var(--pfy-nav-indent-step, #{$nav-indent-step}) - #{$nav-arrow-left} );
            }
        }
        .pfy-lvl-3 > a {
            padding-left: calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + 2 * var(--pfy-nav-indent-step, #{$nav-indent-step}));
            .pfy-nav-arrow {
                left:     calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + 2 * var(--pfy-nav-indent-step, #{$nav-indent-step}) - #{$nav-arrow-left} );
            }
        }
        .pfy-lvl-4 > a {
            padding-left: calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + 3 * var(--pfy-nav-indent-step, #{$nav-indent-step}));
            .pfy-nav-arrow {
                left:     calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + 3 * var(--pfy-nav-indent-step, #{$nav-indent-step}) - #{$nav-arrow-left} );
            }
        }
        .pfy-lvl-5 > a {
            padding-left: calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + 4 * var(--pfy-nav-indent-step, #{$nav-indent-step}));
            .pfy-nav-arrow {
                left:     calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + 4 * var(--pfy-nav-indent-step, #{$nav-indent-step}) - #{$nav-arrow-left} );
            }
        }
        .pfy-lvl-6 > a {
            padding-left: calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + 5 * var(--pfy-nav-indent-step, #{$nav-indent-step}));
            .pfy-nav-arrow {
                left:     calc(var(--pfy-nav-first-indent, #{$nav-first-indent}) + 5 * var(--pfy-nav-indent-step, #{$nav-indent-step}) - #{$nav-arrow-left} );
            }
        }
    } // vertical nav


    //// mobile nav:
    //.pfy-small-screen-nav {
    //    position: absolute;
    //    top: 3em;
    //    left: 0;
    //    background: transparent;
    //    background: var(--mobile-nav-bg-color, #{$mobile-nav-bg-color});
    //    color: var(--mobile-nav-txt-color, #{$mobile-nav-txt-color});
    //}


/* for later use:
    //=== in-page nav:
    &.pfy-in-page-nav,
    .pfy-in-page-nav {
        ol {
            padding: 0;
        }
        li {
            list-style: none;
            display: block;
        }
        .H1 {
            padding-left: 1em;
            margin-left: var(--pfy-in-page-first-indent, #{$in-page-first-indent});
        }
        .H2 {
            padding-left: 2em;
            margin-left: calc(var(--pfy-in-page-first-indent, #{$in-page-first-indent}) + var(--pfy-in-page-indent-step, #{$in-page-indent-step}));
        }
        .H3 {
            padding-left: 3em;
            margin-left: calc(var(--pfy-in-page-first-indent, #{$in-page-first-indent}) + 2 * var(--pfy-in-page-indent-step, #{$in-page-indent-step}));
        }
        .H4 {
            padding-left: 4em;
            margin-left: calc(var(--pfy-in-page-first-indent, #{$in-page-first-indent}) + 3 * var(--pfy-in-page-indent-step, #{$in-page-indent-step}));
        }
        .H5 {
            padding-left: 5em;
            margin-left: calc(var(--pfy-in-page-first-indent, #{$in-page-first-indent}) + 4 * var(--pfy-in-page-indent-step, #{$in-page-indent-step}));
        }
        .H6 {
            padding-left: 6em;
            margin-left: calc(var(--pfy-in-page-first-indent, #{$in-page-first-indent}) + 5 * var(--pfy-in-page-indent-step, #{$in-page-indent-step}));
        }
    } // pfy-in-page-nav




    //=== breadcrumb:
    &.pfy-nav-breadcrumb,
    .pfy-nav-breadcrumb {
        margin: 0;
        padding: 0;
        li {
            list-style: none;
            display: inline-block;
            margin: 0;
            padding: 0;
        }
        .pfy-nav-breadcrumb-separator {
            position: relative;
            display: inline-block;
            width: 1.6em;
            text-align: center;
            font-family: Impact, Charcoal, sans-serif;
            opacity: 0.6;
        }
    } // pfy-nav-breadcrumb
*/

} // pfy-encapsulated


